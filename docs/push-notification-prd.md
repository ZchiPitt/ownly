Push Notification 功能需求（更新版）                                 
                                                                       
  核心使用场景                                                         
                                                                       
  1. 💬 聊天消息提醒 (Marketplace)                                     
                                                                       
  场景: 用户在marketplace发布物品出售/求购，买卖双方需要即时沟通       
                                                                       
  需求细节:                                                            
  - 收到新消息时立即推送通知                                           
  - 显示发送者名称和消息预览（前30-50字符）                            
  - 点击通知直接跳转到对话页面                                         
  - 支持消息已读回执（可选显示）                                       
                                                                       
  验收标准:                                                            
  - 消息送达延迟 < 30秒                                                
  - 用户正在查看该对话时不发送推送（避免打扰）                         
  - 未读消息数量显示在底部导航角标                                     
  - 连续多条消息智能合并（如5秒内来自同一人的消息）                    
                                                                       
  ---                                                                  
  2. 🛒 交易状态提醒 (Marketplace)                                     
                                                                       
  场景: 买卖双方需要知道交易进展                                       
                                                                       
  需求细节:                                                            
  - 有人对你的物品表达购买意向                                         
  - 买家/卖家确认交易                                                  
  - 交易完成确认                                                       
  - 买家留评价后通知卖家                                               
                                                                       
  验收标准:                                                            
  - 卖家第一时间知道有人感兴趣                                         
  - 关键交易节点都有通知                                               
  - 通知内容包含物品名称和对方用户名                                   
                                                                       
  ---                                                                  
  3. 📅 物品过期提醒                                                   
                                                                       
  场景: 用户有食品、药品、化妆品等有保质期的物品                       
                                                                       
  需求细节:                                                            
  - 在物品过期前 N 天发送提醒（用户可配置：1天/3天/7天/14天）          
  - 提醒内容包含：物品名称、过期日期、存放位置                         
  - 点击通知直接跳转到该物品详情页                                     
                                                                       
  验收标准:                                                            
  - 用户收到提醒时，物品还有足够时间处理                               
  - 提醒信息清晰，不需要打开app就知道是什么                            
  - 同一物品不会重复发送相同的过期提醒                                 
                                                                       
  ---                                                                  
  4. 🛡️ 保修到期提醒                                                   
                                                                       
  场景: 用户有电器、数码产品等需要关注保修期的物品                     
                                                                       
  需求细节:                                                            
  - 在保修到期前 N 天提醒（默认30天）                                  
  - 提醒用户检查物品状态                                               
                                                                       
  验收标准:                                                            
  - 用户有足够时间在保修期内处理                                       
  - 提醒中包含保修到期日期                                             
                                                                       
  ---                                                                  
  5. ⏰ 自定义提醒                                                     
                                                                       
  场景: 用户为特定物品设置的个人提醒                                   
                                                                       
  需求细节:                                                            
  - 到达用户设置的日期时发送一次性提醒                                 
                                                                       
  验收标准:                                                            
  - 提醒准时到达                                                       
  - 提醒只发送一次                                                     
                                                                       
  ---                                                                  
  通知优先级                                                           
  ┌────────┬──────────────┬─────────────────┐                          
  │ 优先级 │     类型     │   实时性要求    │                          
  ├────────┼──────────────┼─────────────────┤                          
  │ 高     │ 聊天消息     │ 即时（< 30秒）  │                          
  ├────────┼──────────────┼─────────────────┤                          
  │ 高     │ 交易状态变更 │ 即时（< 1分钟） │                          
  ├────────┼──────────────┼─────────────────┤                          
  │ 中     │ 物品过期提醒 │ 当天推送即可    │                          
  ├────────┼──────────────┼─────────────────┤                          
  │ 中     │ 保修到期提醒 │ 当天推送即可    │                          
  ├────────┼──────────────┼─────────────────┤                          
  │ 低     │ 自定义提醒   │ 当天推送即可    │                          
  └────────┴──────────────┴─────────────────┘                          
  ---                                                                  
  用户控制需求                                                         
                                                                       
  通知偏好设置                                                         
  ┌──────────────┬───────────────┬────────┐                            
  │    设置项    │     选项      │ 默认值 │                            
  ├──────────────┼───────────────┼────────┤                            
  │ 启用推送通知 │ 开/关         │ 关     │                            
  ├──────────────┼───────────────┼────────┤                            
  │ 聊天消息     │ 开/关         │ 开     │                            
  ├──────────────┼───────────────┼────────┤                            
  │ 交易通知     │ 开/关         │ 开     │                            
  ├──────────────┼───────────────┼────────┤                            
  │ 过期提醒     │ 开/关         │ 开     │                            
  ├──────────────┼───────────────┼────────┤                            
  │ 保修提醒     │ 开/关         │ 开     │                            
  ├──────────────┼───────────────┼────────┤                            
  │ 自定义提醒   │ 开/关         │ 开     │                            
  ├──────────────┼───────────────┼────────┤                            
  │ 提前提醒天数 │ 1/3/7/14/30天 │ 7天    │                            
  └──────────────┴───────────────┴────────┘                            
  验收标准:                                                            
  - 每种通知类型可单独控制                                             
  - 关闭某类提醒后立即生效                                             
  - 设置跨设备同步                                                     
                                                                       
  ---                                                                  
  通知交互需求                                                         
                                                                       
  通知中心（App内）                                                    
                                                                       
  分类显示:                                                            
  - 消息 - 聊天消息和交易通知                                          
  - 提醒 - 过期、保修、自定义提醒                                      
                                                                       
  功能:                                                                
  - 未读/已读状态区分                                                  
  - 点击跳转到相关页面（对话/物品）                                    
  - 批量清除已读                                                       
  - 按时间倒序排列                                                     
                                                                       
  验收标准:                                                            
  - 未读总数在底部导航显示角标                                         
  - 消息类通知和提醒类通知可区分                                       
  - 进入通知中心可选择性标记已读                                       
                                                                       
  推送通知（系统级）                                                   
                                                                       
  验收标准:                                                            
  - 锁屏可见                                                           
  - 点击跳转正确                                                       
  - 后台/关闭状态都能收到                                              
  - 使用app图标                                                        
                                                                       
  ---                                                                  
  边界情况处理                                                         
  ┌────────────────────┬──────────────────────────┐                    
  │        情况        │         预期行为         │                    
  ├────────────────────┼──────────────────────────┤                    
  │ 物品被删除         │ 取消相关的待发提醒       │                    
  ├────────────────────┼──────────────────────────┤                    
  │ 用户修改过期日期   │ 重新计算提醒时间         │                    
  ├────────────────────┼──────────────────────────┤                    
  │ 同一天多个物品过期 │ 合并为一条通知           │                    
  ├────────────────────┼──────────────────────────┤                    
  │ 对话被删除/屏蔽    │ 不再发送该对话的消息通知 │                    
  ├────────────────────┼──────────────────────────┤                    
  │ 用户在线查看对话   │ 不发送该对话的推送       │                    
  ├────────────────────┼──────────────────────────┤                    
  │ 用户关闭浏览器权限 │ App内提示开启            │                    
  ├────────────────────┼──────────────────────────┤                    
  │ 用户未登录         │ 不发送推送               │                    
  └────────────────────┴──────────────────────────┘                    
  ---                               